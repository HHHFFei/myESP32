// https://blog.csdn.net/qq_38842418/article/details/128183660 
/******************头文件定义************************/
#include <FastLED.h> //加载灯带头文件
#include <Arduino.h>
/******************头文件定义************************/

/******************宏定义***********************/
#define NUM_LEDS 16*16 // 灯珠数量
#define LED_TYPE WS2812 // 灯带型号
#define COLOR_ORDER GRB // 输入颜色的顺序 根据手册决定
CRGB leds[NUM_LEDS]; // 构建灯珠对象
#define ARRAY_SIZE(A) (sizeof(A) / sizeof((A)[0])) // 求数组长度 总长度/单个长度
/******************宏定义***********************/

int imgdata[256*3] = {121, 121, 121, 
100, 100, 100, 
81, 81, 81, 
81, 81, 81, 
81, 81, 81, 
81, 81, 81, 
61, 61, 67, 
61, 61, 67, 
100, 100, 100, 
100, 100, 100, 
100, 100, 100, 
81, 81, 81, 
81, 81, 81, 
61, 61, 67, 
81, 81, 81, 
81, 81, 81, 
61, 61, 67, 
81, 81, 81, 
61, 61, 67, 
61, 61, 67, 
81, 81, 81, 
81, 81, 81, 
100, 100, 100, 
81, 81, 81, 
61, 61, 67, 
61, 61, 67, 
61, 61, 67, 
49, 64, 64, 
47, 47, 55, 
47, 47, 55, 
61, 61, 67, 
81, 81, 81, 
100, 100, 100, 
100, 100, 100, 
121, 121, 121, 
100, 100, 100, 
30, 208, 214, 
81, 81, 81, 
81, 81, 81, 
49, 64, 64, 
49, 64, 64, 
47, 47, 55, 
47, 47, 55, 
61, 61, 67, 
119, 231, 209, 
20, 143, 146, 
100, 138, 140, 
61, 61, 67, 
81, 81, 81, 
100, 100, 100, 
100, 138, 140, 
100, 138, 140, 
121, 121, 121, 
121, 121, 121, 
100, 138, 140, 
20, 143, 146, 
119, 231, 209, 
61, 61, 67, 
61, 61, 67, 
100, 138, 140, 
81, 81, 81, 
100, 100, 100, 
81, 81, 81, 
61, 61, 67, 
47, 47, 55, 
61, 61, 67, 
81, 81, 81, 
81, 81, 81, 
61, 61, 67, 
61, 61, 67, 
61, 61, 67, 
100, 138, 140, 
100, 138, 140, 
100, 100, 100, 
100, 100, 100, 
121, 121, 121, 
100, 100, 100, 
100, 100, 100, 
81, 81, 81, 
61, 61, 67, 
100, 100, 100, 
81, 81, 81, 
81, 81, 81, 
97, 121, 119, 
119, 231, 209, 
213, 255, 246, 
100, 100, 100, 
100, 100, 100, 
81, 81, 81, 
119, 231, 209, 
213, 255, 246, 
81, 81, 81, 
100, 100, 100, 
81, 81, 81, 
121, 121, 121, 
121, 121, 121, 
121, 121, 121, 
100, 100, 100, 
100, 138, 140, 
213, 255, 246, 
119, 231, 209, 
30, 208, 214, 
30, 208, 214, 
20, 143, 146, 
97, 121, 119, 
81, 81, 81, 
30, 208, 214, 
20, 143, 146, 
100, 138, 140, 
47, 47, 55, 
61, 61, 67, 
81, 81, 81, 
81, 81, 81, 
81, 81, 81, 
61, 61, 67, 
47, 47, 55, 
97, 121, 119, 
100, 138, 140, 
49, 64, 64, 
49, 64, 64, 
97, 121, 119, 
100, 138, 140, 
97, 121, 119, 
100, 138, 140, 
100, 138, 140, 
49, 64, 64, 
81, 81, 81, 
100, 100, 100, 
81, 81, 81, 
119, 231, 209, 
30, 208, 214, 
97, 121, 119, 
61, 61, 67, 
61, 61, 67, 
49, 64, 64, 
49, 64, 64, 
213, 255, 246, 
119, 231, 209, 
100, 100, 100, 
81, 81, 81, 
61, 61, 67, 
61, 61, 67, 
61, 61, 67, 
81, 81, 81, 
61, 61, 67, 
47, 47, 55, 
47, 47, 55, 
61, 61, 67, 
97, 121, 119, 
20, 143, 146, 
20, 143, 146, 
30, 208, 214, 
119, 231, 209, 
81, 81, 81, 
81, 81, 81, 
81, 81, 81, 
47, 47, 55, 
97, 121, 119, 
97, 121, 119, 
61, 61, 67, 
100, 100, 100, 
81, 81, 81, 
100, 100, 100, 
81, 81, 81, 
30, 208, 214, 
81, 81, 81, 
81, 81, 81, 
61, 61, 67, 
97, 121, 119, 
100, 138, 140, 
100, 138, 140, 
49, 64, 64, 
49, 64, 64, 
81, 81, 81, 
121, 121, 121, 
121, 121, 121, 
100, 100, 100, 
121, 121, 121, 
81, 81, 81, 
20, 143, 146, 
119, 231, 209, 
49, 64, 64, 
49, 64, 64, 
81, 81, 81, 
121, 121, 121, 
121, 121, 121, 
121, 121, 121, 
100, 100, 100, 
61, 61, 67, 
81, 81, 81, 
100, 100, 100, 
100, 100, 100, 
100, 100, 100, 
81, 81, 81, 
61, 61, 67, 
49, 64, 64, 
49, 64, 64, 
121, 121, 121, 
100, 100, 100, 
100, 100, 100, 
119, 231, 209, 
213, 255, 246, 
119, 231, 209, 
30, 208, 214, 
30, 208, 214, 
20, 143, 146, 
97, 121, 119, 
100, 100, 100, 
61, 61, 67, 
61, 61, 67, 
97, 121, 119, 
100, 138, 140, 
100, 138, 140, 
30, 208, 214, 
20, 143, 146, 
81, 81, 81, 
100, 100, 100, 
100, 100, 100, 
100, 138, 140, 
20, 143, 146, 
119, 231, 209, 
97, 121, 119, 
61, 61, 67, 
61, 61, 67, 
121, 121, 121, 
121, 121, 121, 
100, 100, 100, 
100, 138, 140, 
100, 138, 140, 
61, 61, 67, 
61, 61, 67, 
47, 47, 55, 
61, 61, 67, 
97, 121, 119, 
100, 138, 140, 
81, 81, 81, 
81, 81, 81, 
100, 100, 100, 
100, 100, 100, 
121, 121, 121, 
100, 100, 100, 
100, 100, 100, 
81, 81, 81, 
81, 81, 81, 
100, 100, 100, 
100, 100, 100, 
121, 121, 121, 
81, 81, 81, 
47, 47, 55, 
81, 81, 81, 
81, 81, 81, 
100, 100, 100, 
81, 81, 81, 
100, 100, 100, 
121, 121, 121, 
121, 121, 121};

/****************外部电路引脚定义**********************/
#define DATA_PIN 3 // 灯带引脚定义
/****************外部电路引脚定义**********************/

/*********************变量数组等定义************************/
CHSV myHSV(80, 255, 100); // 定义色板 色调，饱和度，亮度
uint8_t gCurrentPatternNumber = 0; // 函数数组下标
uint8_t gHue = 0; // 颜色转换标志位CHSV myHSV(0,255,200);//色调，饱和度，亮度 All_colors所用
uint8_t max_bright = 200; // 亮度
/*********************变量数组等定义************************/

/*****************函数数组定义*********************/
void lightTest(void);
//SimplePatternList gPatterns = {All_colors, Run_light, rainbow_run, confetti, juggle};
// 循环遍历的模式列表。每个模式定义为下面的一个单独的函数。
/*****************函数数组定义*********************/
void lightTest()
{
  uint8_t i; // 自加变量

  for (i = 0; i < NUM_LEDS; i++) 
  {
    // leds[i] = CRGB();
    leds[i] = CRGB(log(imgdata[i*3]/3),log(imgdata[i*3+1]/3),log(imgdata[i*3+2]/3));
    delay(30); // 速度调节
    FastLED.show(); // show LED
  }
  delay(30*1000);
}

/*把WS2812Init放入setup函数*/

void WS2812Init(void)
{
  delay(1000); // 上电延迟
  FastLED.addLeds<LED_TYPE, DATA_PIN, COLOR_ORDER>(leds, NUM_LEDS).setCorrection(TypicalLEDStrip);
  // 初始化灯带模板 无需变动复制粘贴即可
  FastLED.setBrightness(max_bright); // 初始化亮度
}

/*把WS2812Run放入loop函数*/

void WS2812Run(void)
{
  lightTest();
}

/********************主函数************************/

void setup()
{
  WS2812Init();
}

void loop()
{
  WS2812Run();
}
